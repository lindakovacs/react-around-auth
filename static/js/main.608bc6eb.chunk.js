(this["webpackJsonpreact-around-auth"]=this["webpackJsonpreact-around-auth"]||[]).push([[0],{22:function(e,t,a){e.exports=a.p+"static/media/logo.8f7611ae.svg"},26:function(e,t,a){e.exports=a(38)},31:function(e,t,a){},38:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(21),c=a.n(o),i=a(7),s=(a(31),a(14)),l=a(2),u=a(1),m=a(22),d=a.n(m);var f=function(e){return r.a.createElement("header",{className:"header"},r.a.createElement("img",{className:"header__logo",src:d.a,alt:"logo"}),r.a.createElement("p",{className:"header__email"},e.loggedIn?e.userEmail:""),r.a.createElement(i.b,{to:e.link.to,className:"header__link",onClick:e.onLogout?e.onLogout:null},e.link.description))},p=r.a.createContext({});var h=function(e){var t=r.a.useContext(p),a=t&&e.card.owner._id===t._id,n="card__delete-button ".concat(a?"card__delete-button_active":""),o=t&&e.card.likes.some((function(e){return e._id===t._id})),c="card__like-button ".concat(o?"card__like-button_active":""),i=e.card.likes.length;return r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{key:e.card._id,className:"card"},r.a.createElement("div",{className:"card__container"},r.a.createElement("button",{type:"button","aria-label":"Delete button",className:n,onClick:function(){e.onCardDelete(e.card)}}),r.a.createElement("div",{className:"card__image",style:{backgroundImage:"url(".concat(e.card.link,")")},onClick:function(){e.onCardClick(e.card)}}),r.a.createElement("div",{className:"card__text"},r.a.createElement("h2",{className:"card__title"},e.card.name),r.a.createElement("div",{className:"card__like-container"},r.a.createElement("button",{type:"button","aria-label":"Like button",className:c,onClick:function(){e.onCardLike(e.card)}}),r.a.createElement("p",{className:"card__like-counter"},i))))))};var _=function(e){var t=r.a.useContext(p);return r.a.createElement(r.a.Fragment,null,r.a.createElement("section",{className:"profile"},r.a.createElement("div",{className:"profile__container"},r.a.createElement("div",{className:"profile__image-container"},r.a.createElement("button",{className:"profile__image-edit","aria-label":"Update profile image",onClick:e.onEditAvatar}),r.a.createElement("img",{className:"profile__image",src:t.avatar,alt:"profile-picture"})),r.a.createElement("div",{className:"profile__info"},r.a.createElement("div",{className:"profile__text"},r.a.createElement("h1",{className:"profile__title"},t.name),r.a.createElement("p",{className:"profile__subtitle"},t.about)),r.a.createElement("button",{className:"button profile__edit-button","aria-label":"Edit button",onClick:e.onEditProfile}))),r.a.createElement("button",{className:"button profile__add-button","aria-label":"Add button",onClick:e.onAddPlace})),r.a.createElement("section",{className:"cards"},r.a.createElement("ul",{className:"cards__grid"},e.cards.map((function(t,a){return r.a.createElement(h,{key:a,card:t,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete})})))))};var g=function(){return r.a.createElement("footer",{className:"footer"},r.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 | Linda Kovacs - Around The U.S."))};var b=function(e){var t=e.email,a=e.loggedIn,o=e.userEmail,c=e.setUserEmail,s=e.password,l=e.setPassword,m=e.handleLoginSubmit,d=e.setEmail,f=Object(u.g)();return Object(n.useEffect)((function(){a&&(f.push("/main"),c(t||o))})),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"auth__container"},r.a.createElement("h2",{className:"auth__title"},"Log in"),r.a.createElement("form",{action:"#",className:"auth",title:"Log in",onSubmit:m,to:"/main"},r.a.createElement("input",{className:"form__input-dark",placeholder:"Email",type:"email",required:!0,value:t,onChange:function(e){return d(e.target.value)}}),r.a.createElement("input",{className:"form__input-dark",placeholder:"Password",type:"password",required:!0,value:s,onChange:function(e){return l(e.target.value)}}),r.a.createElement("button",{type:"submit",className:"form__submit-button_dark",onClick:m},"Log in")),r.a.createElement(i.b,{className:"auth__link",to:"/signup"},"Not a member yet? Sign up here!")))};var E=function(e){e.registered;var t=e.handleRegisterSubmit,a=e.history,o=e.email,c=e.setEmail,s=e.password,l=e.setPassword;return Object(n.useEffect)((function(){localStorage.getItem("token")&&a.push("/main")}),[a]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"auth__container"},r.a.createElement("h2",{className:"auth__title"},"Sign up"),r.a.createElement("form",{action:"#",className:"auth",title:"Sign up",onSubmit:t},r.a.createElement("input",{className:"form__input-dark",placeholder:"Email",type:"email",required:!0,value:o,onChange:function(e){return c(e.target.value)}}),r.a.createElement("input",{className:"form__input-dark",placeholder:"Password",type:"password",required:!0,value:s,onChange:function(e){return l(e.target.value)}}),r.a.createElement("button",{type:"submit",className:"form__submit-button_dark",onSubmit:t,to:"/main"},"Sign up")),r.a.createElement(i.b,{className:"auth__link",to:"/signin"},"Already a member? Log in here!")))};var v=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("section",{className:"form form__".concat(e.name," ").concat(e.isOpen?"form_visible":"")},r.a.createElement("form",{className:"form__container",name:"form__".concat(e.name),action:"#",noValidate:!0,onSubmit:e.onSubmit},r.a.createElement("button",{className:"form__reset-button",type:"reset","aria-label":"Close button",onClick:e.onClose}),r.a.createElement("h2",{className:"form__header"},e.title),e.children)))};var k=function(e){var t=r.a.useContext(p),a=Object(n.useState)(),o=Object(l.a)(a,2),c=o[0],i=o[1],s=Object(n.useState)(),u=Object(l.a)(s,2),m=u[0],d=u[1];return r.a.useEffect((function(){i(t&&t.name),d(t&&t.about)}),[t]),r.a.createElement(v,{name:"edit-profile",title:"Edit profile",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:c,about:m})}},r.a.createElement("fieldset",{className:"form__fields"},r.a.createElement("input",{type:"text",className:"form__input form__title",id:"name-input",name:"name",placeholder:"Name",minLength:"2",maxLength:"40",required:!0,value:c||"",onChange:function(e){i(e.target.value)}}),r.a.createElement("span",{className:"form__input-error",id:"name-input-error"}),r.a.createElement("input",{type:"text",className:"form__input form__subtitle",id:"job-input",name:"job",placeholder:"Job",minLength:"2",maxLength:"200",required:!0,value:m||"",onChange:function(e){d(e.target.value)}}),r.a.createElement("span",{className:"form__input-error",id:"job-input-error"}),r.a.createElement("button",{className:"form__submit-button",type:"submit",value:"Save","aria-label":"Save button"},"Save")))};var N=function(e){var t=r.a.useRef("");return r.a.createElement(v,{name:"change-image",title:"Change profile picture",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(a){a.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})}},r.a.createElement("fieldset",{className:"form__fields"},r.a.createElement("input",{type:"url",className:"form__input form__image-link",id:"linkImage-input",name:"imageLink",placeholder:"Image link",minLength:"2",required:!0,ref:t}),r.a.createElement("span",{className:"form__input-error",id:"linkImage-input-error"}),r.a.createElement("button",{className:"form__submit-button",type:"submit",value:"Save","aria-label":"Save button"},"Save")))};var C=function(e){var t=r.a.useState(""),a=Object(l.a)(t,2),n=a[0],o=a[1],c=r.a.useState(""),i=Object(l.a)(c,2),s=i[0],u=i[1];return r.a.createElement(v,{name:"add-card",title:"New place",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onAddPlace({title:n,link:s})}},r.a.createElement("fieldset",{className:"form__fields"},r.a.createElement("input",{type:"text",className:"form__input form__card-title",id:"card-input",name:"title",placeholder:"Title",minLength:"1",maxLength:"30",required:!0,onChange:function(e){o(e.target.value)}}),r.a.createElement("span",{className:"form__input-error",id:"card-input-error"}),r.a.createElement("input",{type:"url",className:"form__input form__image-link",id:"link-input",name:"link",placeholder:"Image link",required:!0,onChange:function(e){u(e.target.value)}}),r.a.createElement("span",{className:"form__input-error",id:"link-input-error"}),r.a.createElement("button",{className:"form__submit-button",type:"submit",value:"Create","aria-label":"Create button"},"Create")))};var O=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("section",{className:"form form__add-image"+(e.card?" form_visible":"")},r.a.createElement("div",{className:"form__open-image"},r.a.createElement("button",{className:"form__reset-button",type:"reset","aria-label":"Close button",onClick:e.onClose}),r.a.createElement("img",{className:"form__image",src:e.card?e.card.link:"#",alt:e.card?e.card.name:""}),r.a.createElement("p",{className:"form__image-title"},e.card?e.card.name:""))))},j=a(12),S=a(13),y=new(function(){function e(t){var a=t.baseUrl,n=t.headers;Object(j.a)(this,e),this._baseUrl=a,this._headers=n}return Object(S.a)(e,[{key:"getAppInfo",value:function(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}},{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"getUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"updateAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"updateProfile",value:function(e,t){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers,method:"PATCH",body:JSON.stringify({name:e,about:t})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"addNewCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers,method:"POST",body:JSON.stringify({name:e.title,link:e.link})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{headers:this._headers,method:"DELETE"}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"changeLikeCardStatus",value:function(e,t){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:t?"DELETE":"PUT"}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}}]),e}())({baseUrl:"https://around.nomoreparties.co/v1/group-2",headers:{Authorization:"d38c3eff-8aa3-43a2-86b1-ec6a6fc8a616","Content-Type":"application/json"}}),w=a(18),P=a.n(w),L=a(24),U=new(function(){function e(t){Object(j.a)(this,e),this.options=t}return Object(S.a)(e,[{key:"register",value:function(e,t){return this.request("/signup","POST",JSON.stringify({email:e,password:t}))}},{key:"authorize",value:function(e,t){return this.request("/signin","POST",JSON.stringify({email:e,password:t}))}},{key:"getContent",value:function(e){return fetch("".concat(this.options.baseUrl,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then(function(){var e=Object(L.a)(P.a.mark((function e(t){var a;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ok){e.next=2;break}return e.abrupt("return",t.json());case 2:return e.next=4,t.json();case 4:return a=e.sent,e.abrupt("return",Promise.reject(a.error||a.message));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"request",value:function(e,t,a){return fetch("".concat(this.options.baseUrl).concat(e),{headers:{"Content-Type":"application/json"},method:t,body:a}).then((function(e){return e.json()})).then((function(e){return e.message?void 0:(localStorage.setItem("token",e.token),e)}))}}]),e}())({baseUrl:"https://register.nomoreparties.co"}),I=a(25);var A=function(e){var t=e.component,a=Object(I.a)(e,["component"]);return r.a.createElement(u.b,null,(function(){return a.loggedIn?r.a.createElement(t,a):r.a.createElement(u.a,{to:"./signin"})}))};var x=function(e){return r.a.createElement("section",{className:"form form__".concat(e.name," ").concat(e.isOpen?"form_visible":"")},r.a.createElement("div",{className:"form__container"},r.a.createElement("div",{className:"form__tooltip ".concat("success"===e.success?"form__tooltip_success":"form__tooltip_error")}),r.a.createElement("p",{className:"form__tooltip-message"},"success"===e.success?"Success! You have now been registered.":"Oops, something went wrong! Please try again."),r.a.createElement("button",{className:"form__reset-button",type:"reset","aria-label":"Close button",onClick:e.onClose})))};var T=Object(u.h)((function(){var e=Object(n.useState)(!1),t=Object(l.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(!1),i=Object(l.a)(c,2),m=i[0],d=i[1],h=Object(n.useState)(!1),j=Object(l.a)(h,2),S=j[0],w=j[1],P=Object(n.useState)(!1),L=Object(l.a)(P,2),I=L[0],T=L[1],q=Object(n.useState)(null),D=Object(l.a)(q,2),J=D[0],F=D[1],z=Object(n.useState)({}),B=Object(l.a)(z,2),R=B[0],H=B[1],W=Object(n.useState)([]),G=Object(l.a)(W,2),K=G[0],M=G[1],V=Object(n.useState)(!1),Y=Object(l.a)(V,2),$=Y[0],Q=Y[1],X=Object(n.useState)(""),Z=Object(l.a)(X,2),ee=Z[0],te=Z[1],ae=Object(n.useState)(!1),ne=Object(l.a)(ae,2),re=ne[0],oe=ne[1],ce=Object(n.useState)(""),ie=Object(l.a)(ce,2),se=ie[0],le=ie[1],ue=Object(n.useState)(""),me=Object(l.a)(ue,2),de=me[0],fe=me[1],pe=Object(n.useState)(!1),he=Object(l.a)(pe,2),_e=he[0],ge=he[1],be=Object(u.g)();function Ee(){d(!1),o(!1),w(!1),F(null),T(!1)}function ve(e){oe(e),T(!0)}function ke(){le(""),fe("")}function Ne(){Q(!0)}function Ce(){localStorage.removeItem("token"),Q(!1),be.push("/signin")}return Object(n.useEffect)((function(){$&&(y.getUserInfo().then((function(e){H(e)})),y.getInitialCards().then((function(e){e&&M((function(t){return[].concat(Object(s.a)(t),Object(s.a)(e))}))})).catch((function(e){console.log(e)})).catch((function(e){console.log(e)})))}),[$]),Object(n.useEffect)((function(){var e=localStorage.getItem("token");e?U.getContent(e).then((function(e){Q(!0),te(e.data.email)})).catch((function(e){console.log(e)})):Q(!1)}),[$,ee]),r.a.createElement(p.Provider,{value:R},r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/signin"},r.a.createElement(f,{userEmail:ee,loggedIn:$,onLogout:Ce,link:{description:"Sign up",to:"/signup"}}),r.a.createElement(b,{loggedIn:$,email:se,setEmail:le,password:de,setPassword:fe,userEmail:te,setUserEmail:te,handleLogin:Ne,handleLoginSubmit:function(e){e.preventDefault(),U.authorize(se,de).then((function(e){if(e&&e.token)Ne();else{if(ke(),!se||!de)throw new Error("400 - one or more of the fields were not provided");if(!e)throw new Error("401 - the user with the specified email not found")}})).then(ke).then((function(){return be.push("/main")})).catch((function(e){return console.log(e.message)}))},onLogout:Ce,isOpen:I,handleToolTip:ve,success:re}),r.a.createElement(x,{isOpen:I,success:re,onClose:Ee,loggedIn:$})),r.a.createElement(u.b,{exact:!0,path:"/signup"},r.a.createElement(f,{userEmail:ee,loggedIn:$,link:{description:"Log in",to:"/signin"}}),r.a.createElement(E,{registered:_e,email:se,setEmail:le,password:de,setPassword:fe,handleRegisterSubmit:function(e){e.preventDefault(),U.register(se,de).then((function(e){if(!e.data)throw ve("error"),new Error("400 - ".concat(e.message?e.message:e.error))})).then((function(e){return ge(!0),be.push("/signin"),e})).then((function(e){return ve("success"),e})).then(ke).catch((function(e){console.log(e)}))},setUserEmail:te,handleLogin:Ne,handleToolTip:ve}),r.a.createElement(x,{isOpen:I,success:re,onClose:Ee,loggedIn:$})),r.a.createElement(u.b,{exact:!0,path:"/"},$?r.a.createElement(u.a,{to:"/main"}):r.a.createElement(u.a,{to:"/signin"})),r.a.createElement(u.b,{path:"/main"},r.a.createElement(k,{isOpen:a,onClose:Ee,onUpdateUser:function(e){var t=e.name,a=e.about;y.updateProfile(t,a).then((function(e){H(e),o(!1)})).then((function(e){return Ee()})).catch((function(e){return console.log(e)}))}}),r.a.createElement(N,{isOpen:S,onClose:Ee,onUpdateAvatar:function(e){var t=e.avatar;y.updateAvatar(t).then((function(e){H(e),w(!1)})).then((function(e){return Ee()})).catch((function(e){return console.log(e)}))}}),r.a.createElement(C,{isOpen:m,onClose:Ee,onAddPlace:function(e){var t=e.title,a=e.link;y.addNewCard({title:t,link:a}).then((function(e){M([e].concat(Object(s.a)(K)))})).then((function(e){return Ee()})).catch((function(e){return console.log(e)}))}}),r.a.createElement(v,{name:"confirmation",title:"Are you sure?",isOpen:!1,onClose:Ee}),r.a.createElement(O,{onClose:Ee,card:J}),r.a.createElement(f,{loggedIn:$,userEmail:ee,link:{description:"Log out",to:"/signin"},onLogout:Ce}),r.a.createElement(A,{path:"/main",loggedIn:$,component:_,onEditProfile:function(){o(!0)},onAddPlace:function(){d(!0)},onEditAvatar:function(){w(!0)},onCardClick:function(e){F(e)},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===R._id}));y.changeLikeCardStatus(e._id,t).then((function(t){var a=K.map((function(a){return a._id===e._id?t:a}));M(a)})).catch((function(e){return console.log(e)}))},onCardDelete:function(e){y.deleteCard(e._id).then((function(){M(K.filter((function(t){return t._id!==e._id})))})).then((function(e){return Ee()})).catch((function(e){return console.log(e)}))},onClose:Ee,isEditProfilePopupOpen:a,isAddPlacePopupOpen:m,isEditAvatarPopupOpen:S,selectedCard:J,cards:K}),r.a.createElement(g,null)),r.a.createElement(u.a,{from:"*",to:"/"})))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(i.a,null,r.a.createElement(r.a.StrictMode,null,r.a.createElement(T,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[26,1,2]]]);
//# sourceMappingURL=main.608bc6eb.chunk.js.map